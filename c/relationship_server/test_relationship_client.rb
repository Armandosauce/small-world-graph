require File.join(File.dirname(__FILE__),'/../../rails/lib/relationship_client')
rc = RelationshipClient.new('localhost','5555')
rc.store(1,2,0.2);
rc.store(1,3,0.3);
rc.store(1,4,0.4);
rc.store(1,5,0.5);
rc.store(1,6,0.6);
sites = rc.sites_close_to(1)
p sites
rels = rc.distances([1,2,3])
p rels

## Test Bad Size
#
big_ary = []
1000.times do 
  big_ary << 302392
end
#
rels = rc.distances(big_ary)
p rels

big_bad_ary = [305579, 334403, 357962, 146126, 103885, 229932, 305431, 348480, 312456, 38252, 408359, 179194, 120063, 65865, 326351, 28494, 349189, 345958, 96515, 225619, 377066, 360758, 164791, 248730, 84544, 125491, 321404, 96617, 162695, 185761, 244457, 341280, 189703, 153202, 207969, 108400, 167871, 288416, 319452, 293131, 7265, 158681, 344387, 337358, 211883, 218153, 392729, 209297, 12617, 164742, 58279, 57254, 112875, 353248, 282775, 171572, 51849, 242507, 118918, 370705, 316244, 129890, 335579, 180613, 71158, 227341, 332741, 268699, 414791, 361776, 213985, 392634, 307840, 320458, 347122, 145847, 54509, 85704, 245200, 240910, 162273, 284743, 297430, 385102, 201071, 107493, 338996, 76748, 133966, 79193, 186351, 302365, 379308, 285438, 355294, 173065, 136342, 396255, 115250, 273058, 404236, 212335, 370782, 335330, 52200, 53804, 300485, 180464, 102432, 3835, 70829, 321839, 331598, 14164, 122364, 92582, 66513, 75443, 159980, 216853, 279751, 411993, 113103, 401215, 348335, 178873, 153683, 232118, 366311, 234416, 114477, 374186, 392784, 203916, 173026, 396452, 108733, 156782, 96933, 16343, 143073, 5844, 313834, 47100, 213471, 301742, 46253, 274951, 95447, 252569, 266090, 109752, 190715, 328767, 355634, 41588, 267517, 363301, 237606, 410628, 74247, 356131, 18160, 228939, 130899, 144152, 90037, 75612, 366906, 14246, 153743, 357190, 318193, 141843, 229400, 193273, 176390, 56171, 327513, 173836, 74667, 330924, 230237, 376836, 389753, 284756, 77234, 273429, 395367, 61277, 268455, 271795, 297811, 6041, 178629, 14432, 181467, 44681, 324094, 97635, 218834, 76872, 19928, 97612, 355031, 125129, 364823, 73234, 414036, 346646, 253484, 365033, 77251, 159471, 5072, 53698, 80637, 116808, 363805, 309022, 75803, 185684, 15975, 198287, 361430, 8860, 145537, 18061, 19323, 401035, 148137, 174560, 200590, 188547, 388532, 301544, 374491, 158801, 21499, 297105, 314541, 338530, 26602, 407988, 101826, 237594, 350655, 302736, 156177, 363485, 93949, 368895, 290297, 279608, 194112, 28687, 396160, 60150, 10929, 55204, 100370, 370177, 242220, 89179, 109596, 15135, 391919, 136388, 242662, 78423, 231736, 269525, 196182, 371267, 382078, 264012, 117899, 184811, 52403, 283093, 182804, 97707, 284046, 338511, 114855, 102256, 250190, 11441, 159016, 132458, 382140, 400279, 214964, 182418, 55088, 229449, 391641, 137766, 146250, 117996, 267696, 247579, 309861, 92137, 25686, 196557, 203506, 42113, 229692, 360324, 153532, 448, 38866, 53840, 283974, 282795, 409583, 52649, 52244, 3984, 145953, 230416, 110108, 141114, 53025, 77482, 242956, 395381, 324272, 280860, 162662, 182328, 343382, 83206, 216286, 301264, 54749, 90306, 368802, 303896, 134996, 412550, 233527, 231832, 70507, 57523, 236583, 191819, 6171, 362463, 383569, 172517, 156687, 306985, 13222, 402610, 342078, 147554, 87531, 23588, 81084, 132971, 248798, 153134, 21530, 25995, 120199, 266958, 132351, 232415, 301936, 171662, 225127, 284742, 359941, 114526, 54118, 384352, 394347, 74467, 77434, 226536, 90528, 276373, 314004, 146719, 364168, 11062, 105855, 317333, 158420, 253548, 173453, 279624, 371003, 332813, 321400, 193236, 344352, 24649, 390301, 203527, 119765, 211140, 185618, 166, 240456, 323152, 74168, 868, 398767, 307431, 345706, 87617, 154291, 90959, 248502, 143546, 1184, 2535, 363217, 350978, 202305, 287720, 391284, 353533, 45899, 45052, 69256, 27699, 56782, 319262, 363978, 402550, 151635, 205808, 335268, 297257, 69536, 219777, 339297, 267713, 244861, 237589, 66810, 200524, 397231, 29746, 30156, 281934, 116633, 96216, 353694, 185438, 154288, 258645, 218597, 234718, 254652, 148402, 403037, 115777, 368257, 4777, 233068, 113543, 167830, 318064, 47560, 323613, 235235, 27047, 278043, 120007, 353327, 344677, 245116, 288698, 374228, 194365, 62067, 279097, 250541, 29016, 45686, 33981, 29631, 253647, 365115, 221579, 200108, 376461, 54761, 122097, 126671, 256851, 191383, 259752, 380857, 396145, 98328, 191065, 390025, 127848, 156304, 288138, 351288, 153201, 198725, 119292, 53159, 241581, 306860, 210641, 73293, 336435, 112631, 336894, 57745, 237280, 206905, 247948, 34511, 7508, 327141, 254866, 198779, 7300, 21576, 48654, 403707, 124751, 169434, 214962, 106937, 396787, 47884, 410796, 52312, 386265, 50987, 255561, 338038, 4797, 377890, 410572, 406988, 357431, 96927, 86916, 91947, 336259, 378360, 356155, 48930, 172521, 24912, 62894, 228441, 132284, 9164, 13625, 223110, 106587, 231192, 106660, 52593, 45398, 94698, 125183, 307238, 104012, 121393, 358333, 24039, 378699, 373543, 392657, 142625, 280463, 356888, 321937, 322484, 50955, 262856, 23377, 67912, 8720, 112204, 412831, 210933, 333262, 43193, 316958, 20084, 286975, 255729, 408628, 3722, 251153, 4832, 51375, 102168, 320720, 304206, 225077, 357821, 269197, 343968, 12372, 231744, 78273, 304052, 235249, 149239, 326864, 391398, 148161, 240489, 148333, 68201, 208165, 390520, 327843, 87642, 120586, 140868, 221095, 130166, 235401, 31948, 342789, 66164, 252779, 334921, 10540, 117545, 413091, 315696, 341695, 51631, 391115, 188960, 45406, 269595, 234517, 331440, 66570, 79419, 261049, 215229, 93172, 284967, 165974, 235966, 90028, 299572, 202286, 302806, 97627, 114080, 177076, 18405, 41422, 299187, 50319, 57653, 239715, 149230, 357784, 237382, 292749, 243657, 62815, 279472, 179165, 84177, 412310, 276539, 3939, 168375, 107681, 99382, 270047, 74185, 156138, 307542, 283949, 173614, 159614, 141154, 73961, 180395, 131230, 74749, 8776, 375384, 30252, 129107, 232558, 240577, 378838, 6686, 304498, 278853, 63300, 353385, 174139, 404181, 49652, 14594, 83563, 317521, 357810, 393147, 236868, 283022, 70040, 405717, 32584, 175493, 78196, 159980, 178263, 386755, 242780, 16513, 109234, 242128, 394520, 269181, 102903, 292629, 297207, 316977, 398105, 162276, 133834, 16122, 280179, 137999, 269283, 148656, 322869, 265283, 124800, 275222, 34931, 241463, 96372, 144555, 390881, 319416, 65913, 62393, 158551, 62390, 184886, 296218, 317045, 268223, 58582, 119485, 52113, 270427, 413874, 8583, 67130, 274488, 236065, 217055, 134564, 398053, 337131, 225561, 54193, 356080, 213468, 396444, 190188, 250740, 297361, 387700, 123358, 99825, 376835, 74176, 350370, 40861, 156219, 4430, 18324, 315603, 121270, 83096, 237082, 248981, 324453, 53119, 161723, 13236, 322528, 250774, 180868, 367024, 46101, 357638, 34803, 204844, 4862, 117371, 138431, 398809, 399397, 29838, 269063, 300671, 37669, 29622, 205237, 133947, 372628, 10900, 379479, 33177, 131124, 45794, 181745, 14096, 395466, 297936, 274430, 318852, 291546, 331381, 214129, 388029, 91673, 122869, 71363, 164586, 255834, 293344, 330794, 359039, 341704, 219959, 145734, 256395, 111659, 101551, 307221, 127405, 412705, 374406, 18577, 147386, 114821, 195949, 148815, 64615, 308799, 291091, 203122, 276466, 229523, 126800, 209831, 369284, 296321, 83033, 107454, 411910, 326091, 197552, 114444, 180325, 183276, 148147, 8277, 364993, 150527, 391929, 141850, 270080, 107075, 82701, 132230, 88870, 137857, 224162, 361010, 342689, 192162, 258399, 85247, 48490, 4126, 21874, 152549, 54517, 295170, 135876, 43816, 238656, 361287, 321981, 4102, 3312, 286447, 329914, 99399, 199923, 301163, 300420, 100580, 44866, 107944, 76326, 334057, 296950, 190091, 151558, 10696, 85078, 279225, 399317, 60663, 339615, 312687, 7080, 200716, 245444, 28376, 259814, 412222, 266260, 186469, 410431, 205025, 348082, 124775, 61923, 275769, 338037, 156001, 230572, 32887, 328249, 279955, 86178, 86660, 142644, 147018, 145244, 166166, 13262, 108653, 56657, 383671, 50012, 127483, 279346, 285546, 404429, 46425, 405824, 381168, 399023, 32667, 92, 66012, 357380, 60712, 139908, 294155, 199231, 399999, 278588, 19900, 177873, 128061, 91338, 231467, 208535, 241081, 412420, 103215, 115025, 160704, 171408, 133124, 350549, 334254, 192085, 329952, 280525, 368369, 182242, 96237]
rels = rc.distances(big_bad_ary)
p rels

rc.persist
